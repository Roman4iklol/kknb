name: Run build on push
on:
  pull_request:
    types: [opened, synchronize, reopened]
  push:
    branches:
      - main
  schedule:
    - cron: "0 7 * * 1,3,5"
  workflow_dispatch:
env:
  VBUILD_UNIT_TESTS: true
  CONAN_VER: 1.51.3
jobs:
  run-build-mac:
    runs-on: macos-11
    steps:
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."

      - name: Check out repository code
        uses: actions/checkout@v2
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."

      - name: Install Conan
        run: pip3 install conan==${{ env.CONAN_VER }} --force

      - name: Run build
        run: |
          cd ${{ github.workspace }}
          ./build-all.sh

      - run: echo "üçè This job's status is ${{ job.status }}."
#  build:
#    runs-on: ubuntu-latest
#    strategy:
#      fail-fast: false
#      matrix:
#        include:
#          - PLAT: manylinux2014_x86_64
#            DOCKER_IMAGE: quay.io/pypa/manylinux2014_x86_64
#    env:
#      PLAT: ${{ matrix.MANYLINUX_VER }}
#      DOCKER_IMAGE: ${{ matrix.DOCKER_IMAGE }}
#      PY_VER: ${{ matrix.PY_VER }}
#    steps:
#      - uses: actions/checkout@v2
#      - name: Build
#        run: docker run --rm -v `pwd`:/io $DOCKER_IMAGE /io/install_req.sh -e PLAT=$PLAT
#      - name: Result
#        run: ls -al wheelhouse/
